sudo: required
services:
- docker
addons:
  apt:
    packages:
    - python3
    - python3-pip
before_install:
- sudo pip3 install --upgrade pip
- sudo pip3 install --upgrade 'invoke-tools>=0.1.8'
env:
  global:
    # AWS_ACCESS_KEY_ID
    - secure: Ngt973I4brOFkWhQ9w3PfSEQ2I3RUy2wBDpp5qyDcYLDC7CDfOq/nebgXNvFL7/I+rtGJYxXMLj+ZVPHC270PxpPhGzeYMq2fJ6MHG+BA4kHqyWJ4EhIOKPO6weWP7IJ6Qb+z1UdgnBdMWVNyB47tmcBfVQ1gmBK/5J7Ryn6JgY1FYdIvXeV5kWndDQCuC1dguUfdBDaCC7w1KjfCTYGIFRx6I4zDPSBcClTzmT60+ip2U3i7KIqGIG9JEC8GKWiuD25vysY8Ezh28NIlTo34Fkm70l9Ii63BPkbJG7TI4yFomaVOaSwGWMsWNaPj+Q+XFfEYCNc28IJnhBAfV68sN6xdW9wCZEShfGPvzvW5qiI7uo+xVWaB5a5Q2xhGWM1XV0TEoVcpLwnxzJz++8HtrXw/IClQ/C9JxSOjIGU6hW3aDs8jR2vQymTlekCw5ZyzJofumI9HERTERTEj94vokZK7RNRan0qbUkptcE0mraTXJ7xZ1LbemrWBHGxSzUpLUUU/uNRMFm9b3FqfKfiw3Ib1bxTb6LiTp0nPhsgWoAQQGDfvk1hMyEMkdfT+M/w3iBQtH18rtrIjbRXiH2GerEFkdMpMHIqalGOgIHpwi/k9IDX2FrxTf8Vmy5Y4iMLqn5k6+TztJXLKtGiC7rqO4aPuE6K/XGNCPJP1pnNqa8=
    # AWS_SECRET_ACCESS_KEY
    - secure: puVpzLttujyTDXArl8wiqqW9PLJlFMVB14LmL0k33Tr4CNOCU86LSax445DB+VFiiIy7vmA4MHCdqG94JOVQ73vjdALPWzD/1i04vavYFRDXEd1KyV9bmzKALT70LPlwBbnFCUdsPdPdBbhZKOuKLouuqgYpoSrPyqCfUin/GA5z+bxOY5cm1bxSHMEY9JKUguvJwhCHPYH8Zl+aEM/L8eHWKEFU79/7lw9DJ1dTgvuRkMVNan+q27yjHZyZAgCkbfu4ZavG2DkeY7V6tMRqvWvB9GclX7OD7MmveOaSd5odYkRiBHQDBVxuZeXuOTufd3tGWnyl3sA1kLgC8TBtubyYOowqjVPCWyL2Bj8wSHLUWo1aaqZ9ssO72HNXidq/clL3MoOnI+Jjw19rDZslEqZEIcLMkTfM4SLt0Mp/iz//V1Q8D4TMKhTd6uhmjGQX4kHQvX9n6Pac7rP4nacAoX9UdcBBz+j6zx2VM7rKYbqdSJyMwYe2oqSrJzdeots63EAY1O+HweMjoI4kn7wApXOyZYxWYgLJHcv/gL/JevHCtyxlv9fwPinp6O04ehEsVBV3qwOPSJukDckdla1jnaKjegZykoCIyaGasI43L9p1uwAGZk1SAO7aPM7Em6LFM90EdN8MrN/vd31tJZszQfv65AFNbC16taYDj/pCeXs=
    # alpha_SECRET_KEY_BASE
    - secure: ImBrehNvRZB7sBDsATGtNK+L/viThqLx0sqbzJOtdpgENSnik3c8Dkqt1ZzDi7jiRG0U2nIKsJSQIFagtUVt2cY4TOavGrMx0YX7cMCLl01qKTerf9H4G1fPE0ljpQ92d3XBiuF+8AlK16KGpKV/hykb6x6a7SLd0M+/sYFLGvkGzRXSBXITnmfHzts3JblP/GYfcIjrxh9EaiZE2iU5oMuIKMj1cXqXnOuBvT84/nyyYrzhW7rs8vG5TcawxEdNB3Yi+q2u406mMmut0IwTIQrv/hhVPd2rwZegML8+3WPw+fbu/sq2XTzoGax1BQ7ad8NrKT25uS7jA6vwG7SRLzYPLJxf36YYdou3YedzeACuja1mFqRRS+Y65r5pfslyUEdCg1NSzkVq6RLXflrWUZxV09DS4YUDTKJ6Bij3pRzqA/Rl+Cn1yEYhHYIDwo10WddQvDG2ibA/DPwEchFi0Z0CdTOM7IyW+qm29KHG1tz2JXprcmMxU1NNkhH7jpAjXMKFtEVGJigSsnoiDbLE7bVTn+m5NMH0xACzHoF2OaWSTRPJbIC84aK7IvffX27b+gVRqrAziI4Z/nFnVdDxoFQcg3Bz6HF5NutjvkFJ11fXQ/TxH90v8dVBC2Qzc8Y4A8EvmijSozXH1pqpUqDn6OO4qKZ5MVRMryrWgKoj4OM=
    # alpha_GUARDIAN_SECRET_KEY
    - secure: VVq5CWT7bm2RM5HwXmfnLqYl/Bc1ablfirQwu1H+coX2VTmtghMupHLFL+jIZy3u9dNDEDnB/m90UJcyj0hNZEhZspeWvnPACRGJZDJS/ef5UPK9n8YhowvjDuZokw/0Ib1g2/GOERKXfw3uEbBkw7XPsZJZPo0Q65YRzuQkLr6fGBFD4LdDBa+GoUuaRezxZ5gpsaz6pWqarEgXcLfCtkHKqmJCpP2nmXMW+kmwDo9Wiu1Oa4CeUQ7x7wIhsLTkae0uzg2ZtzV+5SMVMNi0Ob/1EdsiP47AyeZrbZ79jusP58XIJojfqql5lvrfELmhRl909XvC/ZpmV40DcMUWjKDZOM0ZTAhJASNKNCaQoxQQjNQkqXAxzdizOBn/1t6C/WR2xg46uZ+g0uh3JPXZEh8arT3b/f08MnYMpg8oUgWkeAUwxSVsm1oSR4DwhjrfXU+/tcDyoahG356QbPpbNbRceTSeoQHqGxa2bhWvQ0Sl6FwZYufQZV17zzT2weV2fLi0kkQey3+SRnxhfFTGQujNTS/YQkU42F9vlAqVarPfmwpAVKbXNO74xxCP4Y2Cq3uojqUyrOapQgcN1WsB5h5YD/ovoRUbf+8LyWaH11O9HPQJNtIME1L47lANeD9EUfZLiI+mAJYRkEXLQg8dF4KUfnjtslzH85nS9Ozb19g=
    # alpha_DB_PASSWORD
    - secure: MFfZLV+zdV5nStE3UBTmcXJYIq7KbmHmXsMSoaBMkvt0hJ/p6nc/h4zDjdX8UPIkpgWFE3eGSQO81KqV7y96iB3hoj7wf6jOcgCBwJKsx9Lrro5MH5/QxfYmCE4FuDf44oo6CylxCZWuPZRy/vFBIoqbn1HtsjTwhhwdYxfcH4CarLTfx0/XYa4ufPn6vv4T7k5r/nGoqaXnfuPqattBMAck8MRMTUfk924Eqe1uLu07GBei3uro+gq4OArgZYZlUIRRHh9WxkCLpUZXel+DuNpsSvx/rMAkrnved8nQixYUamc/tfHSMQFmsjXeUDUJWSba9gNcJKjFUJb3dIWy7wkk1NnrPUB0mHlvmMoCjTbXGFpnK19Lui6w8MrhEUEl6Baawh7iIc/2jA2iXrIrX1DraZRt9wrv/1Z5tAPfqVnpbRP6zEba8Zx00K28Yj3tQV6mNu4s9XTxx9+6RlpHCa/ergezD4C8DLrXeAfsHqShnQT04EkiKLEKV8T8Ih9itzegCh92KLNMljXpPxuvo/eovsxLH4Be0M+mg+u7749X5LZ7MQMamEnmQ+gTiVfOhRxqxGL66/0VZxcALZKqAzfS1t5Xp/X11iz/QJjEg9fGLjqQHe+melKnkTwHAzYrzl0JXsDy3RgVQHAEkp/ZlNLWy66MomsdWYG+WSG+eME=
    # beta_SECRET_KEY_BASE
    - secure: jRs9engVsFRdQrxCQatgF/EutlQ9FqPUS0FyCfTzCcb2u13bfuHvIiPgGxRxY4DlnIswQwS2XW4ifWLWecghp4meIMOzFRp+RTPAt1safNv8otDjoI0mA+G97av/GmjJeZTgWBxwuW/PM56vNKLgSUrpMEjiHyYEfhgkJ01z+lRImDye2V3hkB6oWL/odSeBIO/WTUsoaeLyZpoCh5XfvwMJz8mlB4l/hJs3IIPnPNo1McdSC1wDe7svsGVeBnsfSSI6g4uMDUae8iNGb4mGzuxACYIf6/wlp0D2xmPUfcuUPWjfV722faHyHQtF+wOa5Rsxb2w5AhXKdlHldzNsOQ1pwHG/DJxT/Yd1jj9JTETE2HSyq3BX4C8CD+Eot+mxd1WxstoozjsVeQQYHv+5vcwtB9SYRab8Ju8E6w3IkSM9Vi0QIpBwqNnZWZdBIPexyoxNoklhx9JIafLB7byZF7b1ni1vHGBlgabqdRee/BOYGFvd7vPwGxu0RbcRUDGaLX4eoRRPlWvcfJGd7+WrjoLyufzFlmeXfYr4ByeZ6VLOpGHvPffmgj9yFbOTx0iq07FH++VxozMhoHDkHU7VW25qP2Itnu4w77g4M2jFBHLukWhIItNtawFml2G5kHH9Z2SvROgKR5sU4VuVNMFE0PTdyBsD+jDwiPyhE/dLxMk=
    # beta_GUARDIAN_SECRET_KEY
    - secure: C93edCVTjwSp+xzhjck59ZIrgadJJ8zQybKV/s5e/0Wu66/21oMCar4AqqfjyuoL/yt3Ck18+m42gJhqLY61/64YOGbVRxV4QY2KMlcREWUE+NJh54MwbcSwmkrHKHuG3amZHA8Abu66quPKdrQDJvgsNtsrb+2D1CoLZE9kS+unakw3q5L4ArD5YF6RJGZI3YzXTx/N8JoQLEZkcd3lriQT6RX1oIJdl7xKKQjFN0+2FJ9i7/vv6T9uHox2XaW2Faoz8aHkRv4+Y7DAWByNK8TQs2tEAwzkkeNb2b4gQAmM32/zDgtiXbP3KdFW21QIWz3wiMRMaTFB6hPv8cEiw5kjClcK+3EvOepxM9cYDRfW+ihHl+eJVYm/904KmWG+X34mBOSw6gVI+s30DRwwgaV2fBaFfkmWh0LpVDK9TWrdq9VO8/Q5gwo1/VOj9wg20Plqv1Tl6PcNmIjhvGRFu+0jO72qORw+Yrp4sskFexLimfYMDmsOrs06ZYMbZpyxFEZr5zhmeqa1V8ZQDg2Q+mSA4EqSpJu2UTWPz4dAssYAcqJKnk7bienpf+qumdO8KGZR0fgk4QJEd9ClrMsn/lAOEmsCD+Yk9e+YdaN+T2oRcyOB9RhvNjaZHjTFinU1FyYA84w4MefH4WUVy2/8sH7fVm1POMli5YBRWU/WFks=
    # beta_DB_PASSWORD
    - secure: lgf8EHEhMFS/LHm59qbRokxUfLGaklNZy+ndkXsYU+/kZS+QiCR2F/o/bENlvtQqoRVI9DxsM8F0P7wgfjf0DQm4Wzu+e6KMkfSPT+KBahz6gFTWsCnymBjfKS4pPmiwMFVgrxq54MgdAiTx2Rr84RG5rfdnAnUeyifv42q+uj+C5WXBbxXSguhNe8Y/YuJygvIIR0T7Ue7v1ZR618yHX46HWdQksrv9knNY1ITrfEfbxlbFiKFc5tT875Smuk2vbWYBKDLzHxt9d8JaUGjy0ynSjlsyneJSGtLqaUM/MN8hZj0qHzHgiheeCtrVrnxdhyvG2sJNCWE9+WlHBMkk2d5HkrXN6bCx+qNshcdhTLKvnBJxTOjCZSRumAv2CMPKiOUeDQIiVgn0k5CDbO15CXGVnqnywWbLBsHo44G0QRLCL4jHSI25p7EdfvDj0fZTdCs2K4B1t8a126ENbYMS9yPA+MSb20iWT+KAzJje+8MbrE4PkBgNvk/FHmGQVd6wACa0grgi0RIRkmJ/WVk+86BEBl55tZZku38HL9Y4CfpzcIuD8aMhjUS85BmEVLRak8xf4l6MIslXbCignoznzORL9WTmneBuWebPOuBFmBXLHCetkV/+lK2t28pfxETBjTpUkul2dxo4bTKpxhCyNtAN7yjRFisRp4rA89+WttE=
    # DOCKER_EMAIL
    - secure:  b8zW6mj6DGOv+Ku/xNpVmE1a3bg+24P+1+ZNSQ4QLnelb3wvmbhbXxCvEBKboQTY0/pwBaWGFxOtBKDhcYOQa4rnIpzl7otOTaBxfkXRUh6w0nFz3UlMBpKs2BWH1me9lZk/h5s1C11a3S5JBi5DXq8EXO+ZEExDuyjzSgzF8hd/ifDNGfEyYQ5eY/YLSPLccaKvf7PqtmxiM61+OcFKJqMzI9Mq8e4UuXSQ+Vf9p/8QYXpTStoUU1yWD+2NdFNPJmw5tiXR1hBMu/NautfOFQgvJzA3MejKJldi0f5mrk1qWi10vzVBNve4gd7LM+NcrE8uqwEESxNJZLy6SoGbxooji7yRzeIQol0pfw1jAljJ6oyDtXFMKn8YeJC+iI4cBCtZFRSJcGi9NtLBpx81Iq/s5WKljpXJfD739kirpscmmRRuBarV/AmQG8B+OiO0FG/smEJ89yEylfdrJMzpnuqB7cqq4X2rP9Y4+60kQPYJNPuvOl9zYTp8Ouv8yrm5yl4WAxHSUy+WTQyk5Qq5tOQYL3W+q1kbgnTOYKlTjmhJi4arYrVaDHVuC2pI30Z1b/2eG0sYwxqEASM0U9U7ilhOvcpc3tiij7prWs75id6r2ODRqu4F37xyqmqaFbJt3jDORIWL+1ARM8R4qhkORsQj0Mu1tjeksmeFiLTkzU8=
    # DOCKER_USERNAME
    - secure: VTQcGjtHFtwOinfL7faDawdY0zU6DEHdSXNcPV0B1+5YXJyU/WqMRYhOGWfG3/3t3/zJVWu+TOCXthNhunMFZsP2kqr4po6wsvOwBt2t7rfC2KgZwhb9SNwk8SEXN4ONO1MYeVxBFUc3GUm9wT4eVNXddJORUioSjyOQzZoy8KCZlkRMKTCUyR+xJwbHlbO+wfYrZWCK8Q01uTtFSZ0ad0NEzR9fGFcG1wU9Y3Y6ecwOuNiWg2cqZc/UJRtMCAu6jbckt0LCIrZvYSPZJ1LmNuqrKJ9PpRKwbVpAZMqW+0C0hirS+sZCKanSA6BMpd4yNnjKwWuYymnjisBcnHvzPNaYMQ7ZmVKeTYyrEtzcAxGFzSGbao5c76XVlrr7Ob4CwOSHXq3299qeCK5V/Tfrw40dAOSWUkjHXCwMdRlvAngUhwr7nmRcAw+JpLsf4lXZ7AQswgYWtNn53bS0LE9OSlHmHZq3FKi+gaJ4hvHdaX7V3LYx6lIvuyiRUGMH7O09NtXoPbZA4OutxHl3H/QAJNUqzj/Hhzr+O1IJSTsG0zWPeMVbo/b18r/+GtRXM2c+YLr76zbQwkJ+XQwRZL4od+kcHHIgY1isnRn94WoApkoil3/l3wi7Sbyy7pOTHxcbDIzaRcYZ7q9GUF+bwnOAVgYyJhTSOZBj62H0+wiPA1g=
    # DOCKER_PASSWORD
    - secure: QeKx97qDyGx9Zx7EPCuupoCaTmUjJgwhk/8IEcm0jFtvNvpEDym3lP0l3ZJ+jx1kSS52xcC6+HFCKtEdp4RdZ/HFa1um4pz46UZmV0ZQhCgBqeJlcOMZHmtUSeCcUfXDzP6J0CYbaguLoUxmZJX4BxebSeA1o/+l2RqwO8hSsKjZQ9jtfVLScISoc84LYzuoLGjH3yWOvuDsB9xyUNqSnfztJzv8Oye9BJj81+fzCLqbsWSSxfFiCHm9SjRduftkXl5I/4+3nu/J2C4GqkwY/RUof2toDGnUpa/UTlHTRFUhMq7I8jQclHnVUhFvexFQLTZnjCMNS2bHuQ2Alh5dllSUO4KJNfAcq5YCMHXW8/reT5fDLpKDDJOy5IhOELPInNXMFanM4Z1na6cQbvSgRUeXtiKC8+0ftNr5tQ1bVSlFmVwypzNPPy6jH/Ttt3d/UQMixTR7BWj+4h2zOCEFv0sMEoQkWh3Nu9WleaetxxeUsGDUSWRMXsHqlc50nj5IgyHfOnVgjeVnFzpN1Vwc2em5KGz9pWy3lArjSKv+VKicMiN6kRA7G7Rd51aHw7oUZWJtUHCM4+JP4Sc6IlkqOazNpt4oAOrTFweO3nziAhpsGcxDQB+d0HyJFjHoAYiGTiM9KQjqUhBmfDooKsIhjpYbICYLS45UYbTy7kjv8sw=
    # ANDROID_STORE_PASSWORD
    - secure: KcbLlJE0VU9PEbEyg/avDmTBZP53zc9Ag6RL2dXd6W5Ftk1CcKwigokE2IuGkJKnckrPjgKyfrO1FxYinluGxt99cxcg7EtZIiSMouASnMdsEVbNwuITbZDZzBDORQOx/ZdkZPOSVJgD1ELFx3xVFzzbvt/q6+CYwW0tiQMXPTR6+SWPOUivlpi8vJWBn1NwXub7n6gB6RHFIO1sfFeo7xAOg6lpJRMXGGhn9wuovwHvIS+bi2nrEyrKxsIJyZF2f+YLNxg0TDc+lJR9UHe4Arut5XM+8WElFedKQFWIXTT37H6/WejRubJDLTqf6EKavmtAMZWth2XK8m+RIF0EcmFps2wn8C1PFrhNnHteL0AaemBVMVD1DopByxj1+Gnck6AQ2osHWejRNSIWpXRnO8CLfF/C2gSPVqr/Y24qlzjfphuSQpmPpQXpcLNz/FB2esKe/bi5Te1UuxVyJqSrPY1gROIKmHyPUIig6NvLady++wFDUbAB3nf2eG4pYFIK1uMqHSZhXoCREr8ey6G+Vvdfa+xywHg2hOnKYSPnjvkGqCqIFJU0ll6iOM/k0lIWrRZEmaF6VWkkdBtKQOMdY6z5Q+x8bbl3cwHGYOuC2W0/PTa9s8bIOg9FTdEq+MvdmUctgudHIPR114hzHCtCKzrpN6fNR1IStE9QzcHsFwM=
    # ANDROID_KEY_PASSWORD
    - secure: Tq9klNKZXs1qZIdUxm3yIHFAb+EjjnzkqdBqvqa0CAqlt/LwZ8X0tHV/HwdMqKTfChxXMZABfGT/y/GNOyZzmYDObfhC0l+1rknSW7JD1iI0z2zRbcwoL6H9bVo/brc230GSmC3rsmqw97AhN+7oU133PZbES0DJomBICPUsaN22FKdpJnc5lKSDa+X+/K5OamOd9c2ElUWeSYYr9Xhl7bCRaHTdoluBxpY+IZM+61KX0xSlAmY98pgyAKfJCEQHfonpbI5vpC5P4yEFBHI/yzihd0RzoejiuBqbOtRjgOlujdNXXhXDGc8iMijvQl2laWp1a42IVSlPOvMXm1dfBFyqKGNMqF76Gg65ilSdAnD4G5IFAji3c09r8H+qOfa/JIAbrN7tlOGeHjQVi/v8J5jpIED38NdwQrA0sQLfsfMKYkIYBNIobMBbklI9Vu4a1RMmmbYpw47rWhVcjpfB7gq3KPd5KzTMCVPnB9meZA0PTd6ix4M3XAThcJLFOOPkuqrv00IjjM3ARHJMAxdDXfWlLqzUE/xDaWcALZkIbORUsnbvsjhFIkwRei8BydU9eSSvhoYnV0yNd3f20KNvyXJ5LEGor/OWBpX1QhZQI+EqaUFDeMcArOlv7fk4HUSBbAKghaX/M5GNrsxxfACmIv5Y//dbVExa8hTVpGLtTMs=
  matrix:
    - SERVICE=backend
    - SERVICE=java_client
    - SERVICE="java_client/e2e"
    - SERVICE=android_client
    - SERVICE="android_client/e2e"
script:
  - cd ${TRAVIS_BUILD_DIR}/${SERVICE} && invoke test
after_success:
  - cd ${TRAVIS_BUILD_DIR}/${SERVICE} && invoke publish_test_artifacts && invoke build && invoke deploy
after_failure:
  - cd ${TRAVIS_BUILD_DIR}/${SERVICE} && invoke publish_test_artifacts
notifications:
  slack:
    secure: sqUz8hUcNVeYI68HblkG1O5/Lltf3fR6dPehr4u1IGNiEqThMtB19BTRkrjraGJZ93nvyj6dGmyP6g2GGyUnqgCwtCP/sFh35DefxLyb2iArwreuw8dp4vODGwMjNZvd5rtgWPT4WVcx6HQSwUQc9L6Fp7nOpjdRtpoFL8bUnF4nDZJGvPLVHfYfpPEWAtINJxXJjUHgarxZiFWB30KF6Wl/gTYrDu/p5MbL4AXtBb6XLkBoBmDKtdFnOyTqL4Zq2sYhy98v4d1pagC+1evj58DAnWLdTzAfKbXjn9kicUmmKNV2/f8x62SVpV+4OMgzA2XAPGTOQgyeplXbXFst+iHNREdSdX0w2gJcB3PitWJGtK7+wBtVjOjSH6OXXavELHvqIFRIW54u9PjoPIOKwgN1N+ZakKQCKjPBcRzoS5nPuiJjGivCSSUGbCELzenZJv9JwpZGfJMK1SszpszrWWhrQ6hCEeVRxixV6DzkWlamQk6V1ee5a15pDXFhjDrnjh+Y/6VxtVxPusABRepul7rFRrETvxlU8oR9znV9MJOny4xt79lSLgzDjizUbVTWV4dEi8nHXzYnA1bTlF8SwUdyGIYTJK8ii7KGnIq6kJd8ZCfwXKsus7y/LqSqmDTB8CJRr8M7BYsYcvqKLteAKGfy506eZFCOH+wV4Si8wh0=
  on_success: always
  on_failure: always
